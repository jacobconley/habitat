version: 2.1
jobs:
  test-end-to-end:
    docker:
      # specify the version
      - image: jacobconley/habitat:buster-base@sha256:bc40b30828eec5a34f2b35bb1887b5675c230a1fcf81f634e45453c12f031c84

    working_directory: /go/src/github.com/jacobconley/habitat/
    steps:
      - run: 
          name: Clear metadata
          command: rm -rf ./* ./.[!.]*
          
      - checkout

      - run: 
          name: Set up test fixtures
          command: |
            cd test-fixtures/userland
            yarn install

      - run: build/test-e2e


workflows:
  regression-testing:
    jobs:
      - test-end-to-end